<div id="return-scan-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70 hidden">
    <div class="bg-white p-6 rounded-lg shadow-xl w-11/12 max-w-md text-center">
        <h3 class="text-xl font-bold mb-4">បញ្ជាក់ការចូលមកវិញ</h3>
        <div id="return-video-container" class="">
            <div class="relative w-full h-64 bg-gray-800 rounded-lg overflow-hidden border-4 border-blue-500">
                <video id="return-video" class="w-full h-full object-cover" autoplay muted playsinline></video>
            </div>
        </div>
        <p id="return-scan-status" class="mt-4 text-lg font-medium text-gray-700 h-12">...</p>
        <p id="return-scan-debug" class="text-xs text-gray-500 h-4"></p>
        <button id="cancel-return-scan-btn" class="mt-4 w-full bg-gray-200 text-gray-800 py-2 px-4 rounded-lg font-semibold hover:bg-gray-300"> បោះបង់ </button>
    </div>
</div>

<div id="edit-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70 hidden p-4">
    <div class="bg-white p-6 rounded-lg shadow-xl w-full max-w-md">
        <h3 id="edit-modal-title" class="text-xl font-bold mb-4">កែសម្រួលសំណើ</h3>
        <form id="edit-form" class="space-y-4">
            <input type="hidden" id="edit-request-id">
            <div>
                <label for="edit-reason-search" class="block text-sm font-medium text-gray-700 mb-1">មូលហេតុ</label>
                <div class="relative">
                    <input type="text" id="edit-reason-search" placeholder="វាយ ឬ ជ្រើសរើសមូលហេតុ..." class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" autocomplete="off">
                    <div id="edit-reason-dropdown" class="dropdown-list absolute z-30 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-40 overflow-y-auto hidden"></div>
                </div>
            </div>
            <div id="edit-duration-search-container" class="hidden">
                <label for="edit-duration-search" class="block text-sm font-medium text-gray-700 mb-1">រយៈពេល</label>
                <div class="relative">
                    <input type="text" id="edit-duration-search" class="w-full px-4 py-3 border border-gray-300 rounded-lg" autocomplete="off">
                    <div id="edit-duration-dropdown" class="dropdown-list absolute z-30 w-full mt-1 bg-white border ..."></div>
                </div>
            </div>
            <div id="edit-single-date-container" class="hidden">
                <label for="edit-leave-date-single" class="block text-sm ...">កាលបរិច្ឆេទ</label>
                <input type="text" id="edit-leave-date-single" class="w-full ...">
            </div>
            <div id="edit-date-range-container" class="hidden space-y-4">
                <label for="edit-leave-date-start" class="block text-sm ...">ចាប់ពីថ្ងៃ</label>
                <input type="date" id="edit-leave-date-start" class="w-full ...">
                <label for="edit-leave-date-end" class="block text-sm ...">ដល់ថ្ងៃ</label>
                <input type="date" id="edit-leave-date-end" class="w-full ...">
            </div>
            <p id="edit-error" class="text-red-500 text-sm hidden"></p>
            <div id="edit-loading" class="flex items-center justify-center text-gray-600 hidden">
                <div class="spinner mr-2" style="width: 20px; height: 20px; border-width: 2px;"></div>
                <span>កំពុងដំណើរការ...</span>
            </div>
            <div class="flex justify-end space-x-3 mt-6">
                <button id="cancel-edit-btn" type="button" class="bg-gray-200 text-gray-800 py-2 px-4 rounded-lg font-semibold hover:bg-gray-300"> បោះបង់ </button>
                <button id="submit-edit-btn" type="button" class="bg-blue-600 text-white py-2 px-4 rounded-lg font-semibold shadow-md hover:bg-blue-700"> រក្សាទុកការកែប្រែ </button>
            </div>
        </form>
    </div>
</div>

<div id="delete-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70 hidden p-4">
    <div class="bg-white p-6 rounded-lg shadow-xl w-full max-w-sm text-center">
        <input type="hidden" id="delete-request-id">
        <input type="hidden" id="delete-collection-type">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
        </svg>
        <h3 class="text-xl font-bold mt-4 mb-2">លុបសំណើ?</h3>
        <p class="text-gray-600 mb-6">តើអ្នកពិតជាចង់លុបសំណើនេះមែនទេ? សកម្មភាពនេះ មិនអាចបកក្រោយបានទេ។</p>
        <div class="flex justify-center space-x-3">
            <button id="cancel-delete-btn" class="bg-gray-200 text-gray-800 py-2 px-5 rounded-lg font-semibold hover:bg-gray-300"> បោះបង់ </button>
            <button id="delete-confirm-btn" class="bg-red-600 text-white py-2 px-5 rounded-lg font-semibold shadow-md hover:bg-red-700"> យល់ព្រមលុប </button>
        </div>
    </div>
</div>

<div id="invoice-modal" class="fixed inset-0 z-[70] flex items-center justify-center bg-black bg-opacity-60 hidden p-4">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-md max-h-[90vh] flex flex-col">
        <div class="flex justify-between items-center p-4 border-b border-gray-200">
            <h3 id="invoice-modal-title" class="text-lg font-bold text-gray-800">វិក័យប័ត្រសុំច្បាប់</h3>
            <button id="close-invoice-modal-btn" class="p-1 text-gray-500 hover:text-red-600 rounded-full">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" /></svg>
            </button>
        </div>
        <div class="flex-grow overflow-y-auto p-5" id="invoice-content-wrapper">
            <div id="invoice-content" class="bg-white p-6 border border-gray-300 rounded-lg shadow-inner min-h-[300px]">
                <div class="text-center mb-6 pb-4 border-b border-dashed border-gray-400">
                    <img src="https://i.postimg.cc/FHBn0Fdf/di3-copy.png" alt="Logo" class="h-16 w-16 mx-auto mb-2">
                    <h1 class="text-xl font-bold text-blue-800">ឧស្សាហកម្មឌីជីថល</h1>
                    <p class="text-sm text-gray-500">វិក័យប័ត្របញ្ជាក់ការសុំច្បាប់</p>
                </div>
                <div class="grid grid-cols-2 gap-x-4 gap-y-2 text-sm mb-4">
                    <div><strong class="font-semibold text-gray-700">ឈ្មោះ:</strong></div>
                    <div id="invoice-user-name" class="text-gray-900">...</div>
                    <div><strong class="font-semibold text-gray-700">អត្តលេខ:</strong></div>
                    <div id="invoice-user-id" class="text-gray-900">...</div>
                    <div><strong class="font-semibold text-gray-700">ផ្នែក:</strong></div>
                    <div id="invoice-user-dept" class="text-gray-900">...</div>
                    <div><strong class="font-semibold text-gray-700">ប្រភេទច្បាប់:</strong></div>
                    <div id="invoice-request-type" class="text-gray-900">...</div>
                </div>
                <hr class="my-4 border-gray-200">
                <div class="grid grid-cols-2 gap-x-4 gap-y-2 text-sm mb-4">
                    <div><strong class="font-semibold text-gray-700">រយៈពេល:</strong></div>
                    <div id="invoice-duration" class="text-gray-900">...</div>
                    <div><strong class="font-semibold text-gray-700">កាលបរិច្ឆេទ:</strong></div>
                    <div id="invoice-dates" class="text-gray-900">...</div>
                    <div class="col-span-2"><strong class="font-semibold text-gray-700">មូលហេតុ:</strong></div>
                    <div id="invoice-reason" class="col-span-2 text-gray-900 whitespace-pre-line">...</div>
                </div>
                <hr class="my-4 border-gray-200">
                <div class="grid grid-cols-2 gap-x-4 gap-y-2 text-sm">
                    <div><strong class="font-semibold text-gray-700">ស្ថានភាព:</strong></div>
                    <div><span id="invoice-status" class="font-bold text-green-700">បានយល់ព្រម</span></div>
                    <div><strong class="font-semibold text-gray-700">អនុម័តដោយ:</strong></div>
                    <div id="invoice-approver" class="text-gray-900">...</div>
                    <div><strong class="font-semibold text-gray-700">ម៉ោង/ថ្ងៃអនុម័ត:</strong></div>
                    <div id="invoice-decision-time" class="text-gray-900">...</div>
                    <div class="mt-2"><strong class="font-semibold text-gray-700">ID សំណើរ:</strong></div>
                    <div id="invoice-request-id" class="mt-2 text-gray-500 text-xs break-all">...</div>
                </div>
                <div id="invoice-return-info" class="mt-4 pt-4 border-t border-dashed border-gray-300 hidden">
                    <div class="grid grid-cols-2 gap-x-4 gap-y-2 text-sm">
                        <div><strong class="font-semibold text-gray-700">ការចូលមកវិញ:</strong></div>
                        <div id="invoice-return-status" class="font-semibold text-green-700">...</div>
                        <div><strong class="font-semibold text-gray-700">ម៉ោង/ថ្ងៃចូលវិញ:</strong></div>
                        <div id="invoice-return-time" class="text-gray-900">...</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="p-4 border-t border-gray-200 bg-gray-50 flex justify-end items-center space-x-3">
            <span id="invoice-share-status" class="text-sm text-gray-500"></span>
            <button id="share-invoice-btn" title="Share to Telegram" class="p-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition duration-150 flex items-center justify-center disabled:opacity-50">
                <i class="fab fa-telegram-plane fa-lg"></i>
            </button>
        </div>
    </div>
</div>
